"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var _actions=require("../../tools/actions"),Action=_interopRequireWildcard(_actions),_request=require("../_utils/request"),request=_interopRequireWildcard(_request),_interface=require("../../tools/interface"),Interface=_interopRequireWildcard(_interface),_horus=require("../../vendors/horus.wechat"),_horus2=_interopRequireDefault(_horus),_const=require("../_utils/const");Component({properties:{token:{type:String,value:null}},data:{step:null,STEP_TO:_const.STEP_TO,verify_type:null,retry_times:0},attached:function(){var e=this;Interface.setCompleteHandler(function(t){e.triggerEvent("onFinish",t)})},ready:function(){this.getConfig()},methods:{getConfig:function(){var e=this,t=void 0,r=void 0;request.getUserInfo(e.data.token).then(function(n){switch(t=_const.STEP_TO.landing,n.capture_image){case 0:r=_const.VERIFY_TYPES.all;break;case 1:r=_const.VERIFY_TYPES.ocrfront;break;case 2:r=_const.VERIFY_TYPES.ocrback}e.setData({verify_type:r,step:t,retry_times:n.idcard_retry_time});var i=new _horus2.default({url:_const.TRACK_URL,project:"ocr-idcard-lite",biz_token:e.data.token,ocr_type:3});wx.occur=i.occur.bind(i)},function(){Action.ExitLite({token:e.data.token,status:"tokenError"})})},onNextStep:function(e){var t=e.detail.nextStep,r=Object.assign({},e.detail,{step:t});delete r.nextStep,r.error_code||(r=Object.assign(r,{error_code:null})),this.setData(r)}}});